"use strict";(self.webpackChunkd2sv_sdk_builder=self.webpackChunkd2sv_sdk_builder||[]).push([[6564],{5680:(e,n,t)=>{t.d(n,{xA:()=>p,yg:()=>d});var r=t(6540);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=r.createContext({}),g=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},p=function(e){var n=g(e.components);return r.createElement(s.Provider,{value:n},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=g(t),m=i,d=c["".concat(s,".").concat(m)]||c[m]||u[m]||o;return t?r.createElement(d,a(a({ref:n},p),{},{components:t})):r.createElement(d,a({ref:n},p))}));function d(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var o=t.length,a=new Array(o);a[0]=m;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[c]="string"==typeof e?e:i,a[1]=l;for(var g=2;g<o;g++)a[g]=t[g];return r.createElement.apply(null,a)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},9446:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>g});var r=t(8168),i=(t(6540),t(5680));const o={sidebar_position:3.02,sidebar_label:"D2SV client to server logging",description:"Enables Smartview client-side logging with server-side collation"},a="D2SV client to server logging",l={unversionedId:"general/samples/3_02_client_to_server_logging",id:"general/samples/3_02_client_to_server_logging",title:"D2SV client to server logging",description:"Enables Smartview client-side logging with server-side collation",source:"@site/articles/general/samples/3_02_client_to_server_logging.md",sourceDirName:"general/samples",slug:"/general/samples/3_02_client_to_server_logging",permalink:"/d2sv-sdk/24.4.0/general/samples/3_02_client_to_server_logging",draft:!1,tags:[],version:"current",sidebarPosition:3.02,frontMatter:{sidebar_position:3.02,sidebar_label:"D2SV client to server logging",description:"Enables Smartview client-side logging with server-side collation"},sidebar:"general",previous:{title:"D2 Admin-Groups Sample",permalink:"/d2sv-sdk/24.4.0/general/samples/3_01_admin_groups"},next:{title:"D2SV Custom Dialogs(D2FS) sample",permalink:"/d2sv-sdk/24.4.0/general/samples/3_03_custom_dialog"}},s={},g=[{value:"Instruction to try out the sample",id:"instruction-to-try-out-the-sample",level:3},{value:"Source code structure",id:"source-code-structure",level:3},{value:"Files and their purpose",id:"files-and-their-purpose",level:4},{value:"REST Controller",id:"rest-controller",level:6},{value:"RequireJS module configuration",id:"requirejs-module-configuration",level:6}],p={toc:g},c="wrapper";function u(e){let{components:n,...t}=e;return(0,i.yg)(c,(0,r.A)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"d2sv-client-to-server-logging"},"D2SV client to server logging"),(0,i.yg)("p",null,"D2SV UI uses ",(0,i.yg)("inlineCode",{parentName:"p"},"log4javascript"),' to enable logging for UI components. By default, the library is configured to channel log output to web browser\nconsole. In the past while debugging for some issue in D2 Smartview, we felt the need to correlate this client-side log output with server-side log\noutput generated by back-end components and usually saved in "D2-Smartview.log" file. Driven by this need, we\'ve created this sample plugin which\nre-configures the ',(0,i.yg)("inlineCode",{parentName:"p"},"log4javascript")," and channels the log output to the same server-side log file. Key concepts explored in this plugin are"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"REST endpoint with un-conventional input/output."),(0,i.yg)("li",{parentName:"ul"},"RequireJS module re-configuration")),(0,i.yg)("h3",{id:"instruction-to-try-out-the-sample"},"Instruction to try out the sample"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Build the plugin using ",(0,i.yg)("inlineCode",{parentName:"li"},"npm run build")," from SDK workspace root."),(0,i.yg)("li",{parentName:"ul"},"Copy ",(0,i.yg)("inlineCode",{parentName:"li"},"D2SV-Client2Server-Logging-1.0.0.jar"),' from "dist" folder in workspace root and paste it inside ',(0,i.yg)("inlineCode",{parentName:"li"},"WEB-INF/lib")," folder of a deployed D2 Smartview application."),(0,i.yg)("li",{parentName:"ul"},"Edit D2 Smartview logging configuration file ",(0,i.yg)("inlineCode",{parentName:"li"},"logback.xml")," from ",(0,i.yg)("inlineCode",{parentName:"li"},"WEB-INF/classes")," folder and set the root logging level to ",(0,i.yg)("inlineCode",{parentName:"li"},"INFO"),"."),(0,i.yg)("li",{parentName:"ul"},"Edit ",(0,i.yg)("inlineCode",{parentName:"li"},"rest-api-runtime.properties")," from ",(0,i.yg)("inlineCode",{parentName:"li"},"WEB-INF/classes")," folder and add/append pattern ",(0,i.yg)("inlineCode",{parentName:"li"},"/clientlog")," to the value of property ",(0,i.yg)("inlineCode",{parentName:"li"},"rest.security.anonymous.url.patterns"),"."),(0,i.yg)("li",{parentName:"ul"},"Restart application server on which D2 Smartview is deployed."),(0,i.yg)("li",{parentName:"ul"},"Reload D2-Smartview application in web-browser with additional query parameter ",(0,i.yg)("inlineCode",{parentName:"li"},"loglevel=info"),". ",(0,i.yg)("admonition",{parentName:"li",type:"tip"},(0,i.yg)("p",{parentName:"admonition"},"Complete URL might look like ",(0,i.yg)("inlineCode",{parentName:"p"},"https://mydomain.com/D2-Smartview/ui?loglevel=info#d2")))),(0,i.yg)("li",{parentName:"ul"},"Open console for the web-browser and check if some INFO level log output is present."),(0,i.yg)("li",{parentName:"ul"},"On the server-side open ",(0,i.yg)("strong",{parentName:"li"},"D2-Smartview.log")," file and search for the same log statements as from web-browser console.")),(0,i.yg)("h3",{id:"source-code-structure"},"Source code structure"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"D2SV-Client2Server-Logging\n|\n|   pom.xml\n|   \n+---src\n|   \\---main\n|       +---java\n|       |   \\---com\n|       |       +---emc\n|       |       |       D2PluginVersion.java\n|       |       |       \n|       |       \\---opentext\n|       |           \\---d2\n|       |               +---rest\n|       |               |   \\---context\n|       |               |       \\---jc\n|       |               |               PluginRestConfig_C2SLogging.java\n|       |               |               \n|       |               \\---smartview\n|       |                   \\---c2slogging\n|       |                       |   C2SLoggingPlugin.java\n|       |                       |   \n|       |                       +---api\n|       |                       |       C2SLoggingVersion.java\n|       |                       |       \n|       |                       \\---rest\n|       |                           |   package-info.java\n|       |                           |   \n|       |                           +---api\n|       |                           |   |   IClientLogManager.java\n|       |                           |   |   \n|       |                           |   \\---impl\n|       |                           |           ClientLogManager.java\n|       |                           |           \n|       |                           +---controller\n|       |                           |       InboundExternalLogController.java\n|       |                           |       \n|       |                           \\---model\n|       |                                   HelpModel.java\n|       |                                   LogEntry.java\n|       |                                   LogLevel.java\n|       |                                   LogRequest.java\n|       |                                   \n|       +---resources\n|       |   |   c2slogging-version.properties\n|       |   |   D2Plugin.properties\n|       |   |   \n|       |   \\---smartview\n|       |           SmartView.properties\n|       |           \n|       \\---smartview\n|           |   .csslintrc\n|           |   .eslintrc-html.yml\n|           |   .eslintrc.yml\n|           |   .npmrc\n|           |   c2slogging.setup.js\n|           |   config-editor.js\n|           |   Gruntfile.js\n|           |   package.json\n|           |   server.conf.js\n|           |   \n|           +---src\n|           |   |   c2slogging-extensions.json\n|           |   |   c2slogging-init.js\n|           |   |   component.js\n|           |   |   config-build.js\n|           |   |   Gruntfile.js\n|           |   |   \n|           |   +---bundles\n|           |   |       c2slogging-bundle.js\n|           |   |       \n|           |   +---test\n|           |   |       extensions.spec.js\n|           |   |       \n|           |   \\---utils\n|           |       |   startup.js\n|           |       |   \n|           |       \\---theme\n|           |           |   action.icons.js\n|           |           |   \n|           |           \\---action_icons\n|           |                   action_sample_icon.svg\n|           |                   \n|           \\---test\n|                   Gruntfile.js\n|                   karma.conf.js\n|                   \n\\---target\n")),(0,i.yg)("h4",{id:"files-and-their-purpose"},"Files and their purpose"),(0,i.yg)("p",null,"Following are the list of function oriented source files and their purpose. Other source files present within the plugin are part of\ncommon infrastructure code and explained in ",(0,i.yg)("a",{parentName:"p",href:"../understand.d2sv.plugin"},"Understanding D2SV plugin project"),"."),(0,i.yg)("h6",{id:"rest-controller"},"REST Controller"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"src/main/java/com/opentext/d2/rest/context/jc/PluginRestConfig_C2SLogging.java - Declares Spring Bean ",(0,i.yg)("inlineCode",{parentName:"li"},"IClientLogManager")," through ",(0,i.yg)("inlineCode",{parentName:"li"},"ClientLogManager"),"."),(0,i.yg)("li",{parentName:"ul"},"src/main/java/com/opentext/d2/smartview/c2slogging/rest/api/IClientLogManager.java - Declares log manager interface for REST controllers to use."),(0,i.yg)("li",{parentName:"ul"},"src/main/java/com/opentext/d2/smartview/c2slogging/rest/api/impl/ClientLogManager.java - Log manager implementation that parses and maps input log\nstatements and relays those statements into server side log."),(0,i.yg)("li",{parentName:"ul"},"src/main/java/com/opentext/d2/smartview/c2slogging/rest/controller/InboundExternalLogController.java - Defines two REST endpoints, one receives HTTP POST request\nwith log statements as part of request body, the other responds to HTTP GET requests with help information on how to use the first endpoint."),(0,i.yg)("li",{parentName:"ul"},"src/main/java/com/opentext/d2/smartview/c2slogging/rest/model/HelpModel.java - Serializable POJO that holds help information."),(0,i.yg)("li",{parentName:"ul"},"src/main/java/com/opentext/d2/smartview/c2slogging/rest/model/LogEntry.java - Serializable POJO that represents a single log statement."),(0,i.yg)("li",{parentName:"ul"},"src/main/java/com/opentext/d2/smartview/c2slogging/rest/model/LogLevel.java - Enum that represents D2SV client-side log levels."),(0,i.yg)("li",{parentName:"ul"},"src/main/java/com/opentext/d2/smartview/c2slogging/rest/model/LogRequest.java - Serializable POJO that holds a bunch of log statements together.")),(0,i.yg)("h6",{id:"requirejs-module-configuration"},"RequireJS module configuration"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"src/main/smartview/src/c2slogging-init.js - This file is used to re-configure module ",(0,i.yg)("inlineCode",{parentName:"li"},"nuc/utils/log")," so that it channels log statements to the endpoint\ncreated by Java code from above. It also configures ",(0,i.yg)("inlineCode",{parentName:"li"},"nuc/lib/log4javascript")," to customize the request body format sent to the REST endpoint.",(0,i.yg)("admonition",{parentName:"li",type:"info"},(0,i.yg)("p",{parentName:"admonition"},"The module ",(0,i.yg)("inlineCode",{parentName:"p"},"nuc/utils/log")," encapsulates the ",(0,i.yg)("inlineCode",{parentName:"p"},"log4javascript")," library and provides managed logging API to D2SV UI components.")))))}u.isMDXComponent=!0}}]);