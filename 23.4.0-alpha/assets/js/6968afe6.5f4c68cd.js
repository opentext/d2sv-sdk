"use strict";(self.webpackChunkd2sv_sdk_builder=self.webpackChunkd2sv_sdk_builder||[]).push([[5610],{3905:(e,t,n)=>{n.d(t,{Zo:()=>g,kt:()=>m});var a=n(7294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},g=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,o=e.originalType,s=e.parentName,g=i(e,["components","mdxType","originalType","parentName"]),c=p(n),d=l,m=c["".concat(s,".").concat(d)]||c[d]||u[d]||o;return n?a.createElement(m,r(r({ref:t},g),{},{components:n})):a.createElement(m,r({ref:t},g))}));function m(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var o=n.length,r=new Array(o);r[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[c]="string"==typeof e?e:l,r[1]=i;for(var p=2;p<o;p++)r[p]=n[p];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2635:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var a=n(7462),l=(n(7294),n(3905));const o={},r="Log",i={unversionedId:"api/nuc/utils/log",id:"api/nuc/utils/log",title:"Log",description:"Configurable logging.",source:"@site/articles/api/nuc/utils/log.md",sourceDirName:"api/nuc/utils",slug:"/api/nuc/utils/log",permalink:"/d2sv-sdk/23.4.0/api/nuc/utils/log",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"api",previous:{title:"Load extensions",permalink:"/d2sv-sdk/23.4.0/api/nuc/utils/load-extensions/"},next:{title:"PageLeavingBlocker",permalink:"/d2sv-sdk/23.4.0/api/nuc/utils/page.leaving.blocker"}},s={},p=[{value:"Synopsis",id:"synopsis",level:2},{value:"Usage",id:"usage",level:2},{value:"Configuration Parameters",id:"configuration-parameters",level:2},{value:"Configuration Updates",id:"configuration-updates",level:2},{value:"Beyond Console",id:"beyond-console",level:2}],g={toc:p},c="wrapper";function u(e){let{components:t,...n}=e;return(0,l.kt)(c,(0,a.Z)({},g,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"log"},"Log"),(0,l.kt)("p",null,"Configurable logging."),(0,l.kt)("h2",{id:"synopsis"},"Synopsis"),(0,l.kt)("p",null,"The default logger uses the global configuration:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"require(['nuc/utils/log'], function (log) {\n  log.info('Module loaded.') && console.info(log.last);\n});\n")),(0,l.kt)("p",null,"Log factory allows configuring the log level on a module basis:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"require(['module', 'nuc/utils/log'], function (module, log) {\n  log = log(module.id);\n  log.debug('Module {0} loaded.', module.id) && console.log(log.last);\n});\n")),(0,l.kt)("p",null,"The targets where to log to and the default log level threshold can be set globally:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"require.config({\n  config: {\n    'nuc/utils/log': {\n      page: true,\n      level: 'DEBUG'\n    }\n  }\n});\n")),(0,l.kt)("p",null,"The log level threshold can be changed for any specific module:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"require.config({\n  config: {\n    'nuc/utils/log': {\n      modules: {\n        'csui/controls/table/table.view': { level: 'DEBUG' }\n      }\n    }\n  }\n});\n")),(0,l.kt)("p",null,"The log level, timing and deprecation logging flags, both global and module-specific, can be updated anytime after loading the page:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"log = csui.require('nuc/utils/log');\nlog.set({\n  deprecated: true,\n  modules: {\n    'csui/controls/table/table.view': { level: 'DEBUG' }\n  }\n});\n")),(0,l.kt)("h2",{id:"usage"},"Usage"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"error(message: string [, ...parameters]): boolean\nwarn(message: string [, ...parameters]): boolean\ninfo(message: string [, ...parameters]): boolean\ndebug(message: string [, ...parameters]): boolean\n")),(0,l.kt)("p",null,"Issues a log message with the log level according to the method name, which will be logged, if enabled by the configuration. The parameter ",(0,l.kt)("inlineCode",{parentName:"p"},"message")," can be either a formatted message or a message format with parameter placeholders ",(0,l.kt)("inlineCode",{parentName:"p"},"{N}"),", where ",(0,l.kt)("inlineCode",{parentName:"p"},"N")," is a zero-based index of the parameter. Returns ",(0,l.kt)("inlineCode",{parentName:"p"},"true")," is the message was logged and should be logged on the console too. The property ",(0,l.kt)("inlineCode",{parentName:"p"},"last")," contains the formatted message."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"deprecate(message: string [, ...parameters]): boolean\n")),(0,l.kt)("p",null,"Issues a warning message if the ",(0,l.kt)("inlineCode",{parentName:"p"},"deprecated")," flag is enabled in the configuration. Otherwise is the usage the same es for the ",(0,l.kt)("inlineCode",{parentName:"p"},"warn")," method."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"can(level: string): boolean\n")),(0,l.kt)("p",null,"Check if the current log level is above the configured threshold and logging is enabled. It means that a message with that log level will be logged. The log levels are ",(0,l.kt)("inlineCode",{parentName:"p"},"'ERROR'"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"'WARN'"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"'INFO'")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"'DEBUG'"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"last: string\n")),(0,l.kt)("p",null,"The last formatted log message."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"time(scope: string): void\n")),(0,l.kt)("p",null,"Starts measuring time in a named scope, if enabled by the configuration. Writes directly to the console."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"timeEnd(scope: string): void\n")),(0,l.kt)("p",null,"Ends measuring time in a named scope and prints the time duration on the console, if enabled by the configuration. Writes directly to the console."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"getObjectName(instance: object): string\n")),(0,l.kt)("p",null,"Returns the name of the function object (class) of the specified object instance."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"getStackTrace([frameCountToSkip: number]): string\n")),(0,l.kt)("p",null,"Returns the call stack at the place where it is called, without the call to ",(0,l.kt)("inlineCode",{parentName:"p"},"getStackTrace")," itself. The parameter ",(0,l.kt)("inlineCode",{parentName:"p"},"frameCountToSkip")," can be used to omit further frames from the top."),(0,l.kt)("h2",{id:"configuration-parameters"},"Configuration Parameters"),(0,l.kt)("p",null,"Most of the configuration parameters have to be set before the first module gets loaded. Later changes will have no effect to the most of them. See the next chapter for more information. The parameters and their default values:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"console: true,               // enable logging on the console\nconsoleRe: false,            // enable logging using https://console.re\nlevel: 'WARN',               // change the global log level threshold\ntiming: false,               // enable the timing log entries\ndeprecated: false,           // enable the deprecation warnings\npage: false,                 // enable logging to a bottom page area\nperformanceTimeStamp: false, // prefix every message by the issued time\nmoduleNameStamp: false,      // prefix every message by the originating module name\nserver: false,               // enable posting log messages to the server\nwindow: false,               // enable logging to a new browser window\nmodules: {}                  // change the log level threshold for specific modules\n")),(0,l.kt)("p",null,"The log levels are ",(0,l.kt)("inlineCode",{parentName:"p"},"'ERROR'"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"'WARN'"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"'INFO'")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"'DEBUG'"),". The log level threshold can be set from the highest ",(0,l.kt)("inlineCode",{parentName:"p"},"'ERROR'")," to the lowest ",(0,l.kt)("inlineCode",{parentName:"p"},"'DEBUG'"),". Log messages with the log level higher or equal to the theshold will be actually logged, the others will be skipped."),(0,l.kt)("p",null,"If a log level threshold is set for a specific module, it will override the global value for log messages issued from the specific module. The parameter ",(0,l.kt)("inlineCode",{parentName:"p"},"modules")," expects an object with the following content:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"{\n  '<module name>': { level: string, timing: boolean, deprecated: boolean },\n  ...\n}\n")),(0,l.kt)("p",null,"The parameter ",(0,l.kt)("inlineCode",{parentName:"p"},"server")," can be either ",(0,l.kt)("inlineCode",{parentName:"p"},"false")," or an object with the following parameters, including their default values:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"url: undefined      // the URL to post log messages to\nbatchSize: 10,      // post the log messages in batches instead of single\ntimed: true,        // enables regular flushing incomplete log batches\ntimerInterval: 500, // set the interval of flushing incomplete log batches,\nheaders: {}         // set additional HTTP headers for the log requests\n")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"url")," is mandatory. It will receive ",(0,l.kt)("inlineCode",{parentName:"p"},"'POST'")," requests with objects, for example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "logger": "[default]",\n  "timeStamp": 1201048234203,\n  "level": "ERROR",\n  "url": "http://server/otcs/cs/app",\n  "message": "Object 12345 could not be accessed."\n}\n')),(0,l.kt)("h2",{id:"configuration-updates"},"Configuration Updates"),(0,l.kt)("p",null,"Only the following parameters can be modified after the this module got loaded:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"level: 'WARN',               // change the global log level threshold\ntiming: false,               // enable the timing log entries\ndeprecated: false,           // enable the deprecation warnings\nmodules: {}                  // change the log level threshold for specific modules\n")),(0,l.kt)("p",null,"The initial configuration can be changed by:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"set({ level, timing, deprecated, modules }): void\nreset({ level, timing, deprecated, modules }): void\n")),(0,l.kt)("p",null,"Calling ",(0,l.kt)("inlineCode",{parentName:"p"},"set")," will change the value of the particular parameter, either globally, or for the specified modules."),(0,l.kt)("p",null,"Calling ",(0,l.kt)("inlineCode",{parentName:"p"},"reset")," will apply the defaults (as shown above) for the affected parameters at first and then it will apply the changed parameters on top of them."),(0,l.kt)("p",null,"The initial configuration can be re-applied by calling:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"reload(): void\n")),(0,l.kt)("p",null,"This method will discard changes made by ",(0,l.kt)("inlineCode",{parentName:"p"},"set")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"reset")," and restore the configuration set by ",(0,l.kt)("inlineCode",{parentName:"p"},"require.config")," only."),(0,l.kt)("h2",{id:"beyond-console"},"Beyond Console"),(0,l.kt)("p",null,"If logging is enabled for other targets that ",(0,l.kt)("inlineCode",{parentName:"p"},"console"),", it will be supported by ",(0,l.kt)("a",{parentName:"p",href:"http://log4javascript.org/docs/manual.html"},"log4javascript"),"."),(0,l.kt)("p",null,"Setting ",(0,l.kt)("inlineCode",{parentName:"p"},"consoleRe")," will be supplied by ",(0,l.kt)("a",{parentName:"p",href:"https://console.re/"},"Console.Re"),". Setting ",(0,l.kt)("inlineCode",{parentName:"p"},"page")," will be supplied by ",(0,l.kt)("a",{parentName:"p",href:"http://log4javascript.org/docs/manual.html#inpageappender"},"InPageAppender")," and ",(0,l.kt)("a",{parentName:"p",href:"http://log4javascript.org/docs/manual.html#patternlayout"},"PatternLayout"),". Setting ",(0,l.kt)("inlineCode",{parentName:"p"},"server")," will be supplied by ",(0,l.kt)("a",{parentName:"p",href:"http://log4javascript.org/docs/manual.html#ajaxappender"},"AjaxAppender")," and ",(0,l.kt)("a",{parentName:"p",href:"http://log4javascript.org/docs/manual.html#jsonlayout"},"JsonLayout"),". Setting",(0,l.kt)("inlineCode",{parentName:"p"},"window")," will be supplied by ",(0,l.kt)("a",{parentName:"p",href:"http://log4javascript.org/docs/manual.html#popupappender"},"PopUpAppender")," and ",(0,l.kt)("a",{parentName:"p",href:"http://log4javascript.org/docs/manual.html#patternlayout"},"PatternLayout"),"."),(0,l.kt)("p",null,"The module ",(0,l.kt)("inlineCode",{parentName:"p"},"nuc/lib/log4javascript")," will be loaded on demand, which means that first log messages may be delayed. Before the module ",(0,l.kt)("inlineCode",{parentName:"p"},"nuc/lib/log4javascript")," gets loaded, the log messages will be logged only on the console, if it is enabled. Once the module ",(0,l.kt)("inlineCode",{parentName:"p"},"nuc/lib/log4javascript")," gets loaded, earlier messages will be sent to the logger. They will not get lost. If all log messages have to be sent to the selected targets really right away, the module ",(0,l.kt)("inlineCode",{parentName:"p"},"nuc/lib/log4javascript")," can be forced to be loaded ahead, for example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"require.config({\n  paths: {\n    smart: '/support/smart',\n    csui: '/support/csui'\n  },\n  config: {\n    'nuc/utils/log': {\n      page: true,\n      level: 'DEBUG'\n    }\n  },\n  deps: [\n    'require',\n    'nuc/lib/require.config!nuc/nuc-extensions.json',\n    'nuc/lib/require.config!smart/smart-extensions.json',\n    'nuc/lib/require.config!csui/csui-extensions.json',\n    'nuc/lib/log4javascript'\n  ],\n  callback: function (require) {\n    require([...], function (...) {\n      ...\n    });\n  }\n})\n")))}u.isMDXComponent=!0}}]);